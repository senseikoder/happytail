---
import Layout from "../layouts/Layout.astro";
import Image from "astro/components/Image.astro";
import banner from "../images/banner-contact.webp";
---

<Layout title="Contact :: Happy Tail Grooming">
   <!-- Main -->
   <section id="main" class="container medium bg-wave">
      <header>
         <h2>Contact Us</h2>
         <!-- <p>Tell us what you think about our little operation.</p> -->
      </header>
      <div class="box">
         <span class="image featured"><Image src={banner} alt="FAQs" /></span>

         <div class="info">
            <div>
               <h4>Business Hours</h4>
               <ul class="alt">
                  <li>Mon - Tue - Wed: Closed</li>
                  <li>Thursday: 8:00 am - 5:00 pm</li>
                  <li>Friday: 8:00 am - 5:00 pm</li>
                  <li>Saturday: 8:00 am - 5:00 pm</li>
                  <li>Sunday: 9:00 am - 5:00 pm</li>
               </ul>
            </div>
            <div>
               <h4>Contact Details</h4>
               <ul class="iconos">
                  <li>
                     <i class="icon fa-solid fa-envelope"></i>
                     <a href="mailto:info@happytailgrooming.com"
                        >info@happytailgrooming.com</a
                     >
                  </li>
                  <li>
                     <i class="icon fa-solid fa-phone"></i>
                     <a href="tel:862-253-72-17">862-253-7217</a>
                  </li>
               </ul>
            </div>
         </div>

         <hr />

         <form method="post" id="contacto">
            <div class="row gtr-50 gtr-uniform">
               <div class="col-6 col-12-mobilep">
                  <input
                     type="text"
                     id="nameRokh4m"
                     value=""
                     placeholder="Name"
                     required
                  />
               </div>
               <div class="col-6 col-12-mobilep">
                  <input
                     type="text"
                     id="phoneRokh4m"
                     value=""
                     placeholder="Phone"
                     required
                  />
               </div>
               <div class="col-6 col-12-mobilep">
                  <input
                     type="text"
                     id="namePetRokh4m"
                     value=""
                     placeholder="Name of your pet"
                  />
               </div>
               <div class="col-6 col-12-mobilep">
                  <input
                     type="text"
                     id="breedRokh4m"
                     value=""
                     placeholder="Breed"
                  />
               </div>

               <div class="col-12">
                  <input
                     type="email"
                     name="email"
                     id="emailRokh4m"
                     value=""
                     placeholder="Email"
                  />
               </div>

               <div class="col-6 col-12-narrower">
                  <label class="title">I prefer you contact me by: </label>
                  <input type="checkbox" name="contact" value="Email" />
                  <label>Email</label><br />
                  <input type="checkbox" name="contact" value="Phone" />
                  <label>Phone</label>
                  <input type="checkbox" name="contact" value="Text" />
                  <label>Text (using phone number above)</label>
               </div>

               <div class="col-6 col-12-narrower">
                  <label class="title">How can we help? </label>

                  <input type="radio" name="help" value="Email" />
                  <label>I'd like to make an appointment</label>
                  <input type="radio" name="help" value="Phone" />
                  <label>I'd like to know more about your services</label>
                  <input type="radio" name="help" value="Text" />
                  <label>I'd just like to contact you</label>
               </div>

               <div class="col-12">
                  <textarea
                     id="messageRokh4m"
                     placeholder="Enter your message"
                     rows="4"></textarea>
               </div>

               <!-- T a r r i t o d e l i e m -->
               <div class="fieldset ohnohoney">
                  <label for="name"></label>
                  <input
                     autocomplete="off"
                     type="text"
                     id="name"
                     name="name"
                     placeholder="Your name here"
                  />
                  <label for="email"></label>
                  <input
                     autocomplete="off"
                     type="email"
                     id="nickname"
                     name="nickname"
                     placeholder="Your e-mail here"
                  />
               </div>

               <div class="col-12">
                  <ul class="actions special">
                     <li><input type="submit" value="Send Message" /></li>
                  </ul>
               </div>
            </div>
         </form>
      </div>
   </section>

   <div class="notification is-hidden">
      <!-- <button class="delete"></button> -->
      <span class="text"></span>
   </div>

   <script>
      document.addEventListener("astro:page-load", () => {
         const form = document.querySelector("#contacto");

         if (!form) return;

         const nombre = document.querySelector("#nameRokh4m");
         const telf = document.querySelector("#phoneRokh4m");
         const email = document.querySelector("#emailRokh4m");
         const mensaje = document.querySelector("#messageZhyr7");

         const name = document.querySelector("#name");
         const nickname = document.querySelector("#nickname");
         const notif = document.querySelector(".notification");

         form?.addEventListener("submit", async (event) => {
            event.preventDefault();
            if (!name.value && !nickname.value) {
               const cuerpo = `<h3>Contact Details</h3>
                           <p><b>Name:</b> ${nombre.value}</p>
                           <p><b>Contact Phone:</b> ${telf.value}</p>
                           <p><b>Email:</b> ${email.value}</p>
                           <p><b>Message:</b> ${mensaje.value}</p>
                           <br><br>
                           <p>This message was sent from myhealthfair.com</p>`;

               const emailData = {
                  from: "info@happytailgrooming.com",
                  to: ["molina.frank@outlook.com"],
                  subject: "Contact Web Form",
                  html: cuerpo,
               };

               const res = await fetch("/api/sendEmail.json", {
                  method: "POST",
                  headers: {
                     "Content-Type": "application/json",
                  },
                  body: JSON.stringify(emailData),
               });

               if (res.ok) {
                  notif.classList.toggle("is-success");
                  notif.classList.toggle("is-hidden");
                  notif.lastElementChild.textContent =
                     "Your message was sent! 👍";
               } else {
                  const error = await res.json();
                  console.error("Error:", error);
                  notif.lastElementChild.textContent = "Oh sorry 🙁";
                  notif.classList.toggle("is-hidden");
                  notif.classList.toggle("is-danger");
               }
            }

            setTimeout(() => {
               notif.classList.toggle("is-hidden");
               notif.classList.remove("is-danger");
               notif.classList.remove("is-success");

               nombre.value = "";
               telf.value = "";
               email.value = "";
               mensaje.value = "";
            }, 2000);
         });
      });
   </script>

   <style lang="scss">
      .image img {
         max-width: 100%;
         height: auto;
      }

      .iconos {
         list-style: none;
      }
      .icon {
         color: #56368a;
         margin-right: 1rem;
      }

      .info {
         display: flex;
         gap: 50px;
      }

      .title {
         font-weight: 500;
         font-size: large;
      }

      .ohnohoney {
         opacity: 0;
         position: absolute;
         top: 0;
         left: 0;
         height: 0;
         width: 0;
         z-index: -1;
      }

      @media (max-width: 768px) {
         .info {
            flex-direction: column;
         }
      }
   </style>
</Layout>
